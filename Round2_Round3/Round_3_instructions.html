{{ block title }}
{{ endblock }}

{{ block content }}
<link rel="stylesheet" href="{{static 'css/css.css'}}">
<link rel="stylesheet" href="{{static 'css/modal.css'}}">
<link rel="stylesheet" href="{{static 'css/mgslider.css'}}">
<link rel="stylesheet" href="{{static 'css/calculator.css'}}">
<script type="text/javascript" src="{{ static 'js/pie_chart.js' }}"></script>
<script type="text/javascript" src="{{ static 'js/Script_modal.js' }}"></script>
<script type="text/javascript" src="{{ static 'js/data_quality.js' }}"></script>
<script type="text/javascript" src="{{ static 'js/calculator.js' }}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<script src="{{ static 'js/mgslider.js' }}"></script>

<div class="content-box box-info">

  <!-- Header -->
  <div class="section-header text-center">
    <h3>ü§∫ üßçRound 3</h3>
    <hr class="section-divider">
  </div>

  <!--adjust them to accomodate Recruiter presence as well if treatment is as such.-->

  <!-- Intro -->
  <div class="section-box box-neutral">
        <div class="section-header">
        <p>In this round, you will have <strong>2 minutes</strong> to find as many matching pairs as possible.<br> <br>
         <strong>Difficulty level</strong><br>
          You will face only cards of a <strong>hard level of difficulty</strong>, where each
      card shows an addition problem and a Roman numeral (I or II). Two cards form a matching pair if both
    the sum and the Roman numerals are the same (e.g. 2+3 II and 4+1 II). </p>
        <p style="text-align: center;">
            This time, <strong>you choose your own payment rule</strong>.</p>
            <br>
        <p>
        Before choosing a payment rule, please read the following instructions. You need to pass a quiz on the 
      information in order to proceed.</p>
        </div>
  </div>

{% if not show_recruiter %}
  <!-- Treatments 1,2,9,10 (and also 6,7,14,15 in manager-only mode) -->
  <div class="section-box box-white">
    <div class="section-header">
      <p>
        There is another participant called <strong>the Manager</strong> who has also been recruited on Prolific.
        The Manager is a {{ manager_gender_word }}person who is not part of your group.
      </p>
    </div>
    <div class="task-example text-center mb-4">
      <img src="{% static manager_avatar %}" style="max-width:75%; height: 200px;" alt="Manager avatar" />
    </div>
  </div>

  <div class="section-box box-white">
    <div class="section-header">
      <p>
        <strong>The Manager</strong> must select one participant in your group and earns
        ¬£{{ manager_per_point }} for each point that their selected participant scores in Round 3.
        Therefore, the Manager is motivated to select the participant that they
        <em>believe</em> will perform best in <strong>hard sets</strong>.
      </p>

      <p><strong>How the Manager selects</strong><br>
        The Manager is familiar with the task. When making their selection, the Manager will observe the avatars and
        the Round 2 scores of all participants in your group simultaneously. Below, you can see an example of what 
        the Manager observes.
      </p>

      <div class="task-example text-center mb-4">
        <img src="{% static manager_view_img %}" style="max-width:75%;" alt="Manager view" />
      </div>

      <p>
        The Manager knows that the scores obtained in Round 2 are the result of facing sets either from Mix 1 or Mix 2,
        but they do <strong>not know which set each participant faced</strong>.
      </p>
    </div>
  </div>

{% else %}
  <!-- Treatments 4 and 12: Manager + Recruiter -->
  <div class="section-box box-white">
    <div class="section-header">
      <p>
        There are two other participants: a <strong>{{ manager_gender_word }}Manager</strong> and a
        <strong>{{ recruiter_gender_word }}Recruiter</strong>, who have also been recruited from Prolific.
        They do not know each other and do not communicate with each other.
      </p>
    </div>

    <div class="grid md:grid-cols-2 gap-6" style="display:grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
      <!-- Manager column -->
      <div class="box-neutral" style="padding: 0.5rem 1rem;">
        <div class="task-example text-center mb-2">
          <img src="{% static manager_avatar %}" style="max-width:75%; height: 160px;" alt="Manager avatar" />
        </div>
        <h4>Manager</h4>
        <p>
          The Manager must select one participant in your group and earns <strong>¬£{{ manager_per_point }}</strong>
          for each point that their selected participant scores in Round 3 (hard sets only).
          Therefore, the Manager is motivated to select the participant they <em>believe</em> will perform best in the
          <strong>hard sets</strong>.
        </p>
        <p><strong>How the Manager selects</strong><br>
          The Manager is familiar with the task. When making their selection, the Manager will observe the avatars and
          the Round 2 scores of all participants in your group simultaneously.
        </p>
      </div>

      <!-- Recruiter column -->
      <div class="box-neutral" style="padding: 0.5rem 1rem;">
        <div class="task-example text-center mb-2">
          <img src="{% static recruiter_avatar %}" style="max-width:75%; height: 160px;" alt="Recruiter avatar" />
        </div>
        <h4>Recruiter</h4>
        <p>
          The Recruiter must also select one participant in your group. They earn a
          <strong>¬£{{ recruiter_match_bonus }}</strong> bonus if their selection is the same as the Manager‚Äôs.
          Therefore, the Recruiter is motivated to select the participant <strong>they believe the Manager will select</strong>.
        </p>
        <p><strong>How the Recruiter selects</strong><br>
          The Recruiter is familiar with the task. When making their selection, the Recruiter will observe the
          avatars and the Round 2 scores of all participants in your group (the same information as the Manager).
        </p>
      </div>
    </div>

    <div class="task-example text-center mb-4" style="margin-top: 1rem;">
      <img src="{% static manager_view_img %}" style="max-width:75%;" alt="What they observe" />
    </div>

    <div class="section-header">
      <p>
        The Manager and the Recruiter know that the scores obtained in Round 2 are the result of facing sets either
        from Mix 1 or Mix 2, but they do <strong>not</strong> know which Mix each participant faced. They know they both
        have the same information.
      </p>
    </div>
  </div>
{% endif %}


 <div class="section-box box-contrast">
  <div class="section-header">
    <p><strong>üí∞ Your Payment Rule for Round 3</strong><br>
    You can choose between the following payment rules.
    <ul>
      <strong>Payment Rule A:</strong> You will earn ¬£{{ piece_rate }} per point (i.e. matching pair).
    </ul>
    <ul>
      <strong>Payment Rule B:</strong> You will earn ¬£{{ tournament_rate1 }} per point (i.e. matching pair)
        <strong>if the {{ selector_role }} selects you</strong>. You will earn ¬£0.00 if the {{ selector_role }} does not select you.
    </ul>
    </p>
  </div>
</div>







  




  <!-- Form Fields -->
  <form>
    {% for field in form %}
      {% if field.name not in hidden_fields %}
        {{ formfield field.name }}
      {% endif %}
    {% endfor %}
    <div style="display:none">
      {% for field in form %}
        {% if field.name in hidden_fields %}
          {{ formfield field.name }}
        {% endif %}
      {% endfor %}
    </div>
    

  <!-- Buttons -->
  <div class="buttons-container">
    <div class="instructions-box">
      <p class="instructions-title">Instruction Buttons</p>
      <div class="Instructions">
        <a onclick="open_modal(1)" class="otree-btn-next btn btn-primary">Study Instructions</a>
        <a onclick="open_modal(3)" class="otree-btn-next btn btn-primary">Task Instructions</a>
      </div>
    </div>
    <button id="NextButton" class="otree-btn-next btn btn-primary">Next</button>
  </div>
  </form>


</div>




<!-- Modals -->
<div id="myModal3" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Task Instructions</h2>
      <span class="close" onclick="span_click(3)">&times;</span>
    </div>
    <div class="modal-body">
      {{ include Task_instructions }}
    </div>
  </div>
</div>

<div id="myModal2" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Token Allocation Instructions</h2>
      <span class="close" onclick="span_click(2)">&times;</span>
    </div>
    <div class="modal-body">
      {{ include C.Instructions_choice_path }}
    </div>
  </div>
</div>

<div id="myModal1" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Study Instructions</h2>
      <span class="close" onclick="span_click(1)">&times;</span>
    </div>
    <div class="modal-body">
      {{ include Instructions_path }}
    </div>
  </div>
</div>


<script>
  document.getElementById('revealCalculator').addEventListener('click', () => {
    // show the calculator area
    document.getElementById('calculatorArea').style.display = 'block';
    // hide the reveal button
    document.getElementById('revealCalculator').style.display = 'none';
  });
</script>
{{ endblock }}